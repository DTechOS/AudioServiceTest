#include <iostream>
#include <Windows.h>

// Currently not used. Testing creating windows services 

int main(void)
{
    SC_HANDLE schSCManager;
    SC_HANDLE schService;
   // TCHAR szPath[MAX_PATH];

    const wchar_t* SVCNAME = L"AudioSesPolicy"; // Change to your desired service name
    const wchar_t* serviceDisplayName = L"AudioSesPolicy"; // Change to your desired service display name
    const wchar_t* exePath = L"C:\\Users\\win-dev\\source\\repos\\AudioCaptureService\\x64\\Debug\\AudioCaptureService.exe";

    
    // Get a handle to the SCM database. 

    schSCManager = OpenSCManager(
        NULL,                    // local computer
        NULL,                    // ServicesActive database 
        SC_MANAGER_ALL_ACCESS);  // full access rights 

    // Create the service

    schService = CreateService(
        schSCManager,              // SCM database 
        SVCNAME,                   // name of service 
        SVCNAME,                   // service name to display 
        SERVICE_ALL_ACCESS,        // desired access 
        SERVICE_WIN32_OWN_PROCESS, // service type 
        SERVICE_DEMAND_START,        // start type 
        SERVICE_ERROR_NORMAL,      // error control type 
        exePath,                    // path to service's binary 
        NULL,                      // no load ordering group 
        NULL,                      // no tag identifier 
        NULL,                      // no dependencies 
        NULL,                      // LocalSystem account 
        NULL);                     // no password 


    CloseServiceHandle(schService);
    CloseServiceHandle(schSCManager);

    return 0;

    
}